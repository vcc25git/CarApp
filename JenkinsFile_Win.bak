pipeline {
	agent any
	
	stages {
		stage('Checkout'){
			steps {
				git 'https://github.com/vcc25git/CarApp.git'
			}
		}
		stage('Build'){
			steps {
				bat 'mvn clean compile'
			}
		}
		

		stage('SonarQube analysis') {

			environment {
				scannerHome = tool 'sonarqube' // the name you have given the Sonar Scanner (in Global Tool Configuration)
			}
			steps {
				withSonarQubeEnv(installationName: 'SonarQube') {
				bat "${scannerHome}/bin/sonar-scanner -X"
				}
			}
		}
		
		
		stage('Testing'){
			steps {
			 	bat 'test'
			 	junit '**/target/surefire-reports/TEST-*.xml'
			 }
		}

		stage('Package') {
			steps {
				bat 'mvn package'
			}
		}		
	}
}